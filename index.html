<!DOCTYPE html>
<html lang="en">
  <head>
    <title>CGLBB</title>
    <meta property="og:title" content="CGLBB" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta property="twitter:card" content="summary_large_image" />

    <style data-tag="reset-style-sheet">
      html {  line-height: 1.15;}body {  margin: 0;}* {  box-sizing: border-box;  border-width: 0;  border-style: solid;  -webkit-font-smoothing: antialiased;}p,li,ul,pre,div,h1,h2,h3,h4,h5,h6,figure,blockquote,figcaption {  margin: 0;  padding: 0;}button {  background-color: transparent;}button,input,optgroup,select,textarea {  font-family: inherit;  font-size: 100%;  line-height: 1.15;  margin: 0;}button,select {  text-transform: none;}button,[type="button"],[type="reset"],[type="submit"] {  -webkit-appearance: button;  color: inherit;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner {  border-style: none;  padding: 0;}button:-moz-focus,[type="button"]:-moz-focus,[type="reset"]:-moz-focus,[type="submit"]:-moz-focus {  outline: 1px dotted ButtonText;}a {  color: inherit;  text-decoration: inherit;}pre {  white-space: normal;}input {  padding: 2px 4px;}img {  display: block;}details {  display: block;  margin: 0;  padding: 0;}summary::-webkit-details-marker {  display: none;}[data-thq="accordion"] [data-thq="accordion-content"] {  max-height: 0;  overflow: hidden;  transition: max-height 0.3s ease-in-out;  padding: 0;}[data-thq="accordion"] details[data-thq="accordion-trigger"][open] + [data-thq="accordion-content"] {  max-height: 1000vh;}details[data-thq="accordion-trigger"][open] summary [data-thq="accordion-icon"] {  transform: rotate(180deg);}html { scroll-behavior: smooth  }
    </style>
    <style data-tag="default-style-sheet">
      html {
        font-family: Inter;
        font-size: 16px;
      }

      body {
        font-weight: 400;
        font-style:normal;
        text-decoration: none;
        text-transform: none;
        letter-spacing: normal;
        line-height: 1.15;
        color: var(--dl-color-gray-black);
        background: var(--dl-color-gray-white);

        fill: var(--dl-color-gray-black);
      }
    </style>
    <link
      rel="stylesheet"
      href="https://unpkg.com/animate.css@4.1.1/animate.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800;1,900&amp;display=swap"
      data-tag="font"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"
      data-tag="font"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/@teleporthq/teleport-custom-scripts/dist/style.css"
    />
    <!--This is the head section-->
    <!-- <style> ... </style> -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/blaze-slider@latest/dist/blaze.css"
    />
  </head>
  <body>
    <link rel="stylesheet" href="./style.css" />
    <div>
      <link href="./index.css" rel="stylesheet" />

      <div class="home-container10">
        <section
          id="home"
          data-nav-en="Home"
          data-nav-es="Inicio"
          class="home-home"
        >
          <div>
            <div class="home-container12">
              <script>
                (function(){
                  // Cambia estos textos por los de esa sección
                  var en='Home', es='Inicio';
                  var host = document.currentScript.parentElement;
                  if(host){
                    host.setAttribute('data-nav-en', en);
                    host.setAttribute('data-nav-es', es);
                    host.classList.add('nav-section'); // opcional, útil para depurar
                  }
                })();
              </script>
            </div>
          </div>
          <header data-thq="thq-navbar" class="home-navbar">
            <img
              alt="image"
              src="public/lbb_logo_hw.svg"
              class="home-branding"
            />
            <div class="home-container13">
              <div class="home-container14">
                <!-- 🔘 Botón “Ir a la siguiente sección” (manual con tus IDs) -->
                <div id="section-next-teleport" style="display:inline-block">
                  <button
                    id="section-next-btn"
                    aria-label="Navegar a la siguiente sección"
                    title="Navegar a la siguiente sección"
                    style="
      all: unset;
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 160px; height: 32px; padding: 0 10px;
      border: 1px solid rgba(255,255,255,.35);
      background: rgba(255,255,255,.10);
      color: #fff; font: 600 13px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      letter-spacing: .5px; border-radius: 8px; cursor: pointer;
      user-select: none; -webkit-tap-highlight-color: transparent;
      transition: transform .08s ease;"
                  >
                    Ir a: —
                  </button>

                  <style>
                    #section-next-teleport #section-next-btn:hover {
                      filter: brightness(1.15);
                    }

                    #section-next-teleport #section-next-btn:active {
                      transform: translateY(1px);
                    }

                    /* Fijarlo en pantalla (opcional): */
                    /* #section-next-teleport{ position: fixed; right: 16px; bottom: 64px; z-index: 9999; } */
                  </style>

                  <script>
                      (function(){
                      // ====== EDITA si tienes header fijo (altura en px) ======
                      const HEADER_OFFSET_PX = 80;

                      // ====== TUS SECCIONES (en orden) ======
                      const SECTIONS = ['#home','#content','#stats','#cases','#faq','#social'];

                      // (Opcional) títulos por idioma; si no quieres tocar, usa los que dejo.
                      const TITLES_ES = {
                        '#home':'Inicio', '#content':'Contenido', '#stats':'Estadísticas',
                        '#cases':'Casos', '#faq':'FAQ', '#social':'Social'
                      };
                      const TITLES_EN = {
                        '#home':'Home', '#content':'Content', '#stats':'Stats',
                        '#cases':'Cases', '#faq':'FAQ', '#social':'Social'
                      };

                      // Detecta idioma (usa tu toggle si existe; si no, ES por navegador)
                      function getLang(){
                        try{
                          const d = (document.documentElement.dataset||{}).lang;
                          if (d==='EN'||d==='ES') return d;
                        }catch(e){}
                        if (window.APP_LANG==='EN'||window.APP_LANG==='ES') return window.APP_LANG;
                        try{
                          const list=(navigator.languages&&navigator.languages.length?navigator.languages:[navigator.language])
                            .filter(Boolean).map(x=>String(x).toLowerCase());
                          return list.some(c=>c==='es'||c.startsWith('es-'))?'ES':'EN';
                        }catch(e){}
                        return 'ES';
                      }

                      const root=document.getElementById('section-next-teleport');
                      if(!root) return;
                      const btn=root.querySelector('#section-next-btn');

                      function q(sel){ return document.querySelector(sel); }
                      function topOf(el){ const r=el.getBoundingClientRect(); return r.top+window.scrollY; }

                      // Resuelve secciones y les asigna título
                      function resolveSections(){
                        const lang=getLang();
                        const map = (lang==='EN') ? TITLES_EN : TITLES_ES;
                        return SECTIONS.map(sel=>{
                          const el=q(sel);
                          if(!el) return null;
                          const tAttr = el.getAttribute(lang==='ES'?'data-nav-es':'data-nav-en');
                          const tAlt  = el.getAttribute(lang==='ES'?'data-nav-en':'data-nav-es');
                          const title = (tAttr||tAlt||map[sel]||el.getAttribute('title')||el.id||sel).trim();
                          return { el, title, sel };
                        }).filter(Boolean);
                      }

                      let sections=[], idx=0;

                      function setNextLabel(){
                        const lang=getLang();
                        if(!sections.length){ btn.textContent=(lang==='ES'?'Configura IDs':'Configure IDs'); btn.disabled=true; return; }
                        btn.disabled=false;
                        const next=sections[(idx+1)%sections.length];
                        btn.textContent=(lang==='ES'?'Ir a: ':'Go to: ')+next.title;
                      }

                      function updateIndexByScroll(){
                        if(!sections.length) return;
                        const y=window.scrollY;
                        let found=0;
                        for(let i=0;i<sections.length;i++){
                          const t=topOf(sections[i].el)-HEADER_OFFSET_PX;
                          if(t<=y) found=i;
                        }
                        idx=found;
                        setNextLabel();
                      }

                      function goNext(){
                        if(!sections.length) return;
                        idx=(idx+1)%sections.length;
                        const target=sections[idx].el;
                        try{ target.scrollIntoView({behavior:'smooth', block:'start'}); }catch(e){}
                        setTimeout(setNextLabel,500);
                      }

                      btn.addEventListener('click', goNext);
                      window.addEventListener('scroll', ()=>{ clearTimeout(window.__secnav_t); window.__secnav_t=setTimeout(updateIndexByScroll,80); });
                      window.addEventListener('resize', updateIndexByScroll);
                      window.addEventListener('languagechange', init); // si cambias EN/ES, se actualiza

                      function init(){
                        sections=resolveSections();
                        // Aviso rápido si falta alguna
                        const missing=SECTIONS.filter(sel=>!document.querySelector(sel));
                        if(missing.length){
                          console.warn('No se encontraron estas secciones:', missing);
                        }
                        updateIndexByScroll();
                      }

                      if(document.readyState==='complete'||document.readyState==='interactive'){ setTimeout(init,0); }
                      else{ document.addEventListener('DOMContentLoaded', init); }
                      window.addEventListener('load', ()=>setTimeout(init,200));
                    })();
                  </script>
                </div>
              </div>
            </div>
            <div class="home-container15">
              <div class="home-container16">
                <!-- 🔘 Toggle EN/ES con auto-detector por idioma del navegador -->
                <div id="lang-toggle-teleport" style="display:inline-block">
                  <button
                    id="lang-toggle-btn"
                    aria-label="Cambiar idioma"
                    title="Cambiar idioma"
                    style="
      all: unset;
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 40px; height: 32px; padding: 0 10px;
      border: 1px solid rgba(255,255,255,.35);
      background: rgba(255,255,255,.10);
      color: #fff; font: 600 13px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      letter-spacing: .5px; border-radius: 8px; cursor: pointer;
      user-select: none; -webkit-tap-highlight-color: transparent;
      transition: transform .08s ease;
    "
                  >
                    EN
                  </button>

                  <style>
                    #lang-toggle-teleport #lang-toggle-btn:hover{ filter: brightness(1.15); }
                    #lang-toggle-teleport #lang-toggle-btn:active{ transform: translateY(1px); }

                    /* Para fijarlo en pantalla, descomenta:
                    #lang-toggle-teleport{ position: fixed; right: 16px; bottom: 16px; z-index: 9999; } */
                  </style>

                  <script>
                    (function () {
                      const STORAGE_KEY = 'site:lang';
                      const LANGS = ['EN', 'ES'];
                      const DEFAULT_LANG = 'EN'; // fallback final si todo falla

                      const root = document.getElementById('lang-toggle-teleport');
                      if (!root) return;
                      const btn = root.querySelector('#lang-toggle-btn');

                      // ✅ Detección de español por idioma del navegador
                      function browserPrefersSpanish(){
                        try{
                          const list = (navigator.languages && navigator.languages.length ? navigator.languages : [navigator.language])
                                        .filter(Boolean)
                                        .map(x => String(x).toLowerCase());
                          // español si alguno empieza por 'es-' o es exactamente 'es'
                          return list.some(code => code === 'es' || code.startsWith('es-'));
                        }catch(e){ return false; }
                      }

                      // Carga preferencia guardada o, si no existe, decide por idioma del navegador
                      function initialLang(){
                        try{
                          const saved = localStorage.getItem(STORAGE_KEY);
                          if (saved && LANGS.includes(saved)) return saved;
                        }catch(e){}
                        return browserPrefersSpanish() ? 'ES' : DEFAULT_LANG;
                      }

                      // Exposición global + data-lang para CSS
                      function expose(lang){
                        window.APP_LANG = lang;                                   // variable global
                        document.documentElement.dataset.lang = lang;             // <html data-lang='ES|EN'>
                        // document.documentElement.setAttribute('lang', lang.toLowerCase()); // opcional
                      }

                      function apply(lang){
                        btn.textContent = lang;
                        btn.setAttribute('data-lang', lang);
                        expose(lang);
                        try{ localStorage.setItem(STORAGE_KEY, lang); }catch(e){}
                        window.dispatchEvent(new CustomEvent('languagechange', { detail: { lang } }));
                      }

                      let current = initialLang();
                      if (!LANGS.includes(current)) current = DEFAULT_LANG;
                      apply(current);

                      btn.addEventListener('click', function(){
                        const i = LANGS.indexOf(current);
                        current = LANGS[(i + 1) % LANGS.length];
                        apply(current);
                      });
                    })();
                  </script>
                </div>
              </div>
            </div>
          </header>
          <video
            src="public/video.mp4"
            loop=""
            muted=""
            poster="public/video_moment-1500h-1500h.jpg"
            preload="auto"
            autoplay=""
            playsinline=""
            class="home-video"
          ></video>
          <div class="home-hero-content">
            <div class="home-header-container">
              <div class="home-container17">
                <div class="home-container18">
                  <section
                    id="single"
                    style="
  width:100%;
  max-width:min(100%, 900px);
  margin:0 auto;
  padding:0 clamp(12px,3vw,32px);
  box-sizing:border-box;
  color:#fff;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
"
                  ></section>

                  <script>
                    (() => {
                      const SHEET_ID = '14Z6jZrF9j9J08PQFLHTJL2PuEnQ62HCE0pGJ80gqaeQ';
                      const jsonUrl  = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

                      const TARGET_ROW_INDEX = 1; // segunda fila

                      const getCurrentLang = () => {
                        const appLang = (window.APP_LANG || localStorage.getItem('site:lang') || 'ES').toString().toUpperCase();
                        return (appLang === 'EN') ? 'EN' : 'ES';
                      };

                      function mapRowToRecord(rowCells, lang) {
                        const c = rowCells || [];
                        return {
                          title : (lang === 'EN' ? (c[0]?.v||'') : (c[2]?.v||'')).trim(),
                          text  : (lang === 'EN' ? (c[1]?.v||'') : (c[3]?.v||'')).trim()
                        };
                      }

                      function renderParagraphs(t){
                        const c=document.createElement('div');
                        c.style.cssText='display:block;margin:0;white-space:pre-wrap;';
                        (t||'').split(/\n{2,}/).forEach((chunk,i)=>{
                          const p=document.createElement('p');
                          p.textContent=chunk.trim();
                          // tamaño duplicado respecto al original (30px máx en vez de 18px)
                          p.style.cssText=`margin:${i? '14px 0 0':'0'};line-height:1.6;font-size:clamp(30px,4vw,36px);color:#fff;`;
                          c.appendChild(p);
                        });
                        return c;
                      }

                      let cachedRows = [];

                      function renderSingle(lang){
                        const host = document.getElementById('single');
                        if (!host) return;
                        host.innerHTML = '';

                        const row = cachedRows?.[TARGET_ROW_INDEX];
                        if (!row || !row.c) {
                          host.innerHTML = `<p style='color:#f88'>No encontré la segunda línea (índice ${TARGET_ROW_INDEX}).</p>`;
                          return;
                        }

                        const rec = mapRowToRecord(row.c, lang);
                        if (!rec.title && !rec.text) {
                          host.innerHTML = `<p style='color:#ffb;'>La segunda línea no tiene título ni texto.</p>`;
                          return;
                        }

                        const card = document.createElement('article');
                        // sin fondo, sin borde ni sombra
                        card.style.cssText = `
                          display:block;
                          padding:clamp(14px,2vw,24px);
                          color:#fff;
                        `;

                        if (rec.title) {
                          const h=document.createElement('h3');
                          h.textContent = rec.title;
                          // tamaño duplicado respecto al original (52px máx en vez de 26px)
                          h.style.cssText = 'margin:0 0 12px 0;font-weight:800;font-size:clamp(36px,4.8vw,52px);line-height:1.3;color:#fff;';
                          card.appendChild(h);
                        }
                        if (rec.text) {
                          card.appendChild(renderParagraphs(rec.text));
                        }

                        host.appendChild(card);
                      }

                      async function init(){
                        const host = document.getElementById('single');
                        if (!host) return;
                        try{
                          const res = await fetch(jsonUrl, { cache:'no-store' });
                          const txt = await res.text();
                          const start = txt.indexOf('setResponse('), end = txt.lastIndexOf(');');
                          if (start === -1 || end === -1) {
                            host.innerHTML = `<p style='color:#f88'>No pude leer el Sheet</p>`;
                            return;
                          }
                          const data = JSON.parse(txt.substring(start + 'setResponse('.length, end));
                          cachedRows = data?.table?.rows || [];
                          renderSingle(getCurrentLang());
                        }catch(err){
                          console.error('Error cargando sheet:', err);
                          host.innerHTML = `<p style='color:#f88'>Error al cargar datos</p>`;
                        }
                      }

                      window.addEventListener('load', init);
                      window.addEventListener('languagechange', () => renderSingle(getCurrentLang()));
                      window.addEventListener('storage', ev => {
                        if (ev.key === 'site:lang') renderSingle(getCurrentLang());
                      });
                    })();
                  </script>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section
          id="content"
          data-nav-en="Services"
          data-nav-es="Servicios"
          class="home-content"
        >
          <div>
            <div class="home-container20">
              <script>
                (function(){
                  // Cambia estos textos por los de esa sección
                  var en='Services', es='Servicios';
                  var host = document.currentScript.parentElement;
                  if(host){
                    host.setAttribute('data-nav-en', en);
                    host.setAttribute('data-nav-es', es);
                    host.classList.add('nav-section'); // opcional, útil para depurar
                  }
                })();
              </script>
            </div>
          </div>
          <div class="home-container21">
            <div class="home-container22">
              <section
                id="feed"
                style="
  display:flex;
  flex-direction:column;
  gap: clamp(16px, 2vw, 28px);
  width: 100%;
  max-width: min(100%, 1100px);
  margin: 0 auto;
  padding: 0 clamp(12px, 3vw, 32px);
  box-sizing: border-box;
"
              ></section>

              <script>
                (() => {
                  /* ========= Sheet de Google y hoja ========= */
                  const SHEET_ID   = '14Z6jZrF9j9J08PQFLHTJL2PuEnQ62HCE0pGJ80gqaeQ';
                  const SHEET_GID  = '0';  // ← TU gid
                  const RANGE      = 'A:G';        // columnas

                  const params = new URLSearchParams({ tqx: 'out:json' });
                  if (SHEET_GID) params.set('gid', SHEET_GID);
                  if (RANGE)     params.set('range', RANGE);

                  const jsonUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?${params.toString()}`;

                  const getCurrentLang = () => {
                    const appLang = (window.APP_LANG || localStorage.getItem('site:lang') || 'ES').toString().toUpperCase();
                    return (appLang === 'EN') ? 'EN' : 'ES';
                  };

                  const isVideoFile = u => /\.(mp4|webm|ogg)(\?|#|$)/i.test(u||'');
                  const vimeoMatch  = u => (u||'').match(/vimeo\.com\/(\d+)/);
                  const tiktokMatch = u => (u||'').match(/tiktok\.com\/@[^/]+\/video\/(\d+)/);
                  const driveMatch  = u => (u||'').match(/drive\.google\.com\/file\/d\/([^/]+)/);
                  const isYouTube   = u => /(?:youtu\.be\/|youtube\.com\/watch\?v=)/i.test(u||'');
                  const isInstagram = u => /instagram\.com\/(?:p|reel)\//i.test(u||'');

                  function createBoxedIframe(src,{ratio='16/9',rounded='12px'}={}) {
                    const b=document.createElement('div');
                    b.style.cssText=`position:relative;width:100%;margin:0 auto clamp(10px,1.5vw,16px);aspect-ratio:${ratio};border-radius:${rounded};overflow:hidden;background:#000;max-height:85vh;`;
                    const i=document.createElement('iframe');
                    i.src=src; i.loading='lazy'; i.allowFullscreen=true;
                    i.style.cssText='position:absolute;inset:0;width:100%;height:100%;border:0;display:block;';
                    b.appendChild(i);
                    return b;
                  }

                  function renderMedia({url,poster}) {
                    const s=(url||'').trim();
                    if(!s) return null;
                    if(isVideoFile(s)){
                      const v=document.createElement('video');
                      v.src=s; v.controls=true; v.playsInline=true;
                      if(poster) v.setAttribute('poster',poster);
                      v.style.cssText='display:block;width:100%;height:auto;border-radius:12px;margin:0 0 clamp(10px,1.5vw,16px) 0;';
                      return v;
                    }
                    const vm=vimeoMatch(s);
                    if(vm) return createBoxedIframe(`https://player.vimeo.com/video/${vm[1]}`);
                    const tk=tiktokMatch(s);
                    if(tk) return createBoxedIframe(`https://www.tiktok.com/embed/${tk[1]}`,{ratio:'9/16'});
                    const gd=driveMatch(s);
                    if(gd) return createBoxedIframe(`https://drive.google.com/file/d/${gd[1]}/preview`);
                    const img=document.createElement('img');
                    img.src=s; img.alt='';
                    img.loading='lazy';
                    img.style.cssText='display:block;width:100%;height:auto;border-radius:12px;margin:0 0 clamp(10px,1.5vw,16px) 0;object-fit:cover;';
                    return img;
                  }

                  function renderParagraphs(t){
                    const c=document.createElement('div');
                    c.style.cssText='display:block;margin:0;white-space:pre-wrap;';
                    (t||'').split(/\n{2,}/).forEach((chunk,i)=>{
                      const p=document.createElement('p');
                      p.textContent=chunk.trim();
                      p.style.cssText=`margin:${i? '10px 0 0':'0'};line-height:1.6;font-size:clamp(15px,2vw,18px);color:#fff;`;
                      c.appendChild(p);
                    });
                    return c;
                  }

                  function makeCoolButton({ url, label }) {
                    const a = document.createElement('a');
                    a.href = url; a.target = '_blank'; a.rel = 'noopener';
                    a.textContent = (label || '').trim() || (getCurrentLang()==='EN' ? 'Open' : 'Abrir');
                    a.style.cssText = `
                      display:inline-block;
                      margin-top: 10px;
                      padding: 12px 20px;
                      border-radius:10px;
                      background: #2b2b2b;
                      text-decoration:none;
                      font-weight:700;
                      font-size: clamp(14px,1.8vw,16px);
                      color:#fff;
                      text-align:center;
                      box-shadow: 0 2px 6px rgba(0,0,0,.3);
                      transition: all .25s ease;
                      transform-origin: center;
                    `;
                    a.onmouseenter = () => {
                      a.style.background = '#3a3a3a';
                      a.style.boxShadow = '0 0 15px rgba(180,180,180,.6), 0 0 30px rgba(180,180,180,.4)';
                      a.style.transform = 'scale(1.07) rotate(-1deg)';
                    };
                    a.onmouseleave = () => {
                      a.style.background = '#2b2b2b';
                      a.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
                      a.style.transform = 'scale(1) rotate(0deg)';
                    };
                    return a;
                  }

                  let cachedRows = [];
                  function mapRowToRecord(rowCells, lang) {
                    const c = rowCells || [];
                    return {
                      title : (lang === 'EN' ? (c[0]?.v||'') : (c[2]?.v||'')).trim(),
                      text  : (lang === 'EN' ? (c[1]?.v||'') : (c[3]?.v||'')).trim(),
                      media : (c[4]?.v || '').trim(),
                      href  : (c[5]?.v || '').trim(),
                      poster: (c[6]?.v || '').trim()
                    };
                  }

                  function renderFeedForLang(lang) {
                    const feed = document.getElementById('feed');
                    if (!feed) return;
                    feed.innerHTML = '';

                    // 🔑 Salta las 3 primeras filas (encabezado + 2 adicionales)
                    const rows = cachedRows.slice(2);

                    rows.forEach(r => {
                      const rec = mapRowToRecord(r.c || [], lang);
                      if (!rec.title && !rec.text) return;

                      const url = rec.media || rec.href || '';
                      const hasTikTok = tiktokMatch(url);
                      const hasVimeo  = vimeoMatch(url);
                      const isYT      = isYouTube(url);
                      const isIG      = isInstagram(url);

                      const card=document.createElement('article');
                      card.style.cssText=`
                        display:block;
                        border:1px solid rgba(255,255,255,0.15);
                        background: rgba(0,0,0,0.1);
                        border-radius:16px;
                        padding:clamp(14px,2vw,24px);
                        box-shadow:0 2px 10px rgba(0,0,0,.3);
                        transition: transform .2s ease, box-shadow .2s ease;
                        color:#fff;
                        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
                        ${!rec.media ? 'margin: 32px 0;' : ''}
                      `;
                      card.onmouseenter=()=>{card.style.boxShadow='0 6px 18px rgba(0,0,0,.4)'; card.style.transform='translateY(-2px)';};
                      card.onmouseleave=()=>{card.style.boxShadow='0 2px 10px rgba(0,0,0,.3)'; card.style.transform='none';};

                      if (rec.title) {
                        const h=document.createElement('h3');
                        h.textContent=rec.title;
                        h.style.cssText='margin:0 0 8px 0;font-weight:800;font-size:clamp(18px,2.4vw,26px);line-height:1.3;color:#fff;';
                        card.appendChild(h);
                      }

                      if (hasTikTok || hasVimeo) {
                        const mediaEl = renderMedia({url: rec.media || rec.href, poster: rec.poster});
                        if (mediaEl) card.appendChild(mediaEl);
                        if (rec.text) card.appendChild(renderParagraphs(rec.text));
                        feed.appendChild(card);
                        return;
                      }

                      if (isYT || isIG) {
                        if (rec.text) card.appendChild(renderParagraphs(rec.text));
                        const label = isYT
                          ? (getCurrentLang()==='EN' ? 'Watch on YouTube' : 'Ver en YouTube')
                          : (getCurrentLang()==='EN' ? 'View on Instagram' : 'Ver en Instagram');
                        const wrapper = document.createElement('div');
                        wrapper.style.textAlign = 'center';
                        const btn = makeCoolButton({ url, label });
                        wrapper.appendChild(btn);
                        card.appendChild(wrapper);
                        feed.appendChild(card);
                        return;
                      }

                      if (rec.media) {
                        const mediaEl = renderMedia({url:rec.media, poster:rec.poster});
                        if (mediaEl) card.appendChild(mediaEl);
                        if (rec.text) card.appendChild(renderParagraphs(rec.text));
                        feed.appendChild(card);
                        return;
                      }

                      if (rec.href) {
                        const wrapper = document.createElement('div');
                        wrapper.style.textAlign = 'center';
                        const btn = makeCoolButton({ url: rec.href, label: rec.text });
                        wrapper.appendChild(btn);
                        card.appendChild(wrapper);
                        feed.appendChild(card);
                        return;
                      }

                      if (rec.text) {
                        card.appendChild(renderParagraphs(rec.text));
                      }

                      feed.appendChild(card);
                    });
                  }

                  async function fetchOnceAndRenderInitial(){
                    const feed=document.getElementById('feed');
                    if (!feed) return;
                    try{
                      const res=await fetch(jsonUrl,{cache:'no-store'});
                      const txt=await res.text();
                      const start=txt.indexOf('setResponse('), end=txt.lastIndexOf(');');
                      if (start === -1 || end === -1) {
                        feed.innerHTML = `<p style='color:#f88'>No pude leer el Sheet</p>`;
                        return;
                      }
                      const data=JSON.parse(txt.substring(start + 'setResponse('.length, end));
                      cachedRows = data?.table?.rows || [];
                      renderFeedForLang(getCurrentLang());
                    }catch(err){
                      console.error('Error cargando sheet:', err);
                      feed.innerHTML = `<p style='color:#f88'>Error al cargar datos</p>`;
                    }
                  }

                  window.addEventListener('load', fetchOnceAndRenderInitial);
                  window.addEventListener('languagechange', () => renderFeedForLang(getCurrentLang()));
                  window.addEventListener('storage', ev => {
                    if (ev.key === 'site:lang') renderFeedForLang(getCurrentLang());
                  });
                })();
              </script>
            </div>
          </div>
        </section>
        <section
          id="stats"
          data-nav-en="Statistical Data"
          data-nav-es="Datos Estadisticos"
          class="home-stats"
        >
          <div>
            <div class="home-container24">
              <script>
                (function(){
                  // Cambia estos textos por los de esa sección
                  var en='Stats', es='Estadisticas';
                  var host = document.currentScript.parentElement;
                  if(host){
                    host.setAttribute('data-nav-en', en);
                    host.setAttribute('data-nav-es', es);
                    host.classList.add('nav-section'); // opcional, útil para depurar
                  }
                })();
              </script>
            </div>
          </div>
          <div class="home-container25">
            <div class="home-container26">
              <section
                id="stats"
                style="
  width:100%;
  max-width:1200px;
  margin:0 auto;
  padding:0 clamp(12px,3vw,32px);
  box-sizing:border-box;
  color:#fff;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
"
              >
                <div class="stats-grid"></div>
              </section>

              <style>
                .stats-grid{
                  display:grid;
                  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
                  align-items:stretch;
                  gap: 1px;
                  background: rgba(255,255,255,0.15);
                  border-top: 1px solid rgba(255,255,255,0.15);
                  border-left: 1px solid rgba(255,255,255,0.15);
                }
                .stats-grid .cell{
                  background: transparent;
                  text-align:center;
                  padding: clamp(20px,3vw,36px) clamp(10px,2vw,24px);
                }
                .stats-grid .value{
                  font-size: clamp(28px,6vw,64px);
                  line-height: 1.1;
                  font-weight: 600;
                  font-style: italic;
                  margin: 0 0 8px 0;
                  letter-spacing: .5px;
                  will-change: contents;
                }
                .stats-grid .label{
                  font-size: clamp(13px,2.2vw,16px);
                  line-height: 1.4;
                  color: rgba(255,255,255,.75);
                  margin: 0;
                  white-space: pre-wrap;
                }
              </style>

              <script>
                (() => {
                  /* ========= Sheet de Google y hoja ========= */
                  const SHEET_ID   = '14Z6jZrF9j9J08PQFLHTJL2PuEnQ62HCE0pGJ80gqaeQ';
                  const SHEET_GID  = '500247363';  // ← TU gid
                  const RANGE      = 'A:D';        // columnas

                  const params = new URLSearchParams({ tqx: 'out:json' });
                  if (SHEET_GID) params.set('gid', SHEET_GID);
                  if (RANGE)     params.set('range', RANGE);

                  const jsonUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?${params.toString()}`;

                  // ---------- Utils ----------
                  const clean   = s => (s||'').toString().replace(/[\u00A0\u202F\u2007]/g,' ').trim();
                  const cellVal = c => (c?.v == null ? '' : c.v);                 // num/raw
                  const cellStr = c => clean(c?.f ?? c?.v ?? '');                 // prefer formatted

                  const getCurrentLang = () => {
                    const appLang = (window.APP_LANG || localStorage.getItem('site:lang') || 'ES').toString().toUpperCase();
                    return appLang === 'EN' ? 'EN' : 'ES';
                  };

                  // Detecta si la primera fila parece encabezado
                  function isHeaderRow(row){
                    const a = cellStr(row?.c?.[0]).toLowerCase();
                    const b = cellStr(row?.c?.[1]).toLowerCase();
                    const c = cellStr(row?.c?.[2]).toLowerCase();
                    const d = cellStr(row?.c?.[3]).toLowerCase();
                    const inA = ['statistic','estadistica','estadística','numero','número','valor'].includes(a);
                    const inB = ['unit','tipo','unidad'].includes(b);
                    const inC = ['text','label','descripcion','descripción'].includes(c);
                    const inD = ['texto','text','label','descripcion','descripción'].includes(d);
                    return (inA && inB) || (inA && inC) || (inA && inD) || (inB && inC) || (inB && inD);
                  }

                  // K/M compaction
                  function formatCompact(num){
                    const n = Number(num);
                    if (!isFinite(n)) return String(num);
                    const abs = Math.abs(n);
                    if (abs >= 1_000_000) return (n/1_000_000).toFixed(1).replace(/\.0$/,'') + ' M';
                    if (abs >= 1_000)     return (n/1_000).toFixed(1).replace(/\.0$/,'') + ' K';
                    return n.toLocaleString();
                  }

                  const easeOutCubic = x => 1 - Math.pow(1 - x, 3);

                  function finalText(n, unit){
                    const u = clean(unit).toLowerCase();
                    if (typeof n === 'number' && isFinite(n)){
                      if (u === '%') return `${formatCompact(n)}%`;
                      if (u === '$') return `$${formatCompact(n)}`;
                      return u ? `${formatCompact(n)} ${u}` : formatCompact(n);
                    }
                    return u ? `${n} ${u}` : String(n);
                  }

                  function animateCount(el, target, unit, duration=1200){
                    const u = clean(unit).toLowerCase();
                    if (typeof target !== 'number' || !isFinite(target)){
                      el.textContent = finalText(target, u);
                      return;
                    }
                    const start = performance.now();
                    function frame(now){
                      const p = Math.min(1, (now - start) / duration);
                      const val = target * easeOutCubic(p);
                      el.textContent = finalText(val, u);
                      if (p < 1) requestAnimationFrame(frame);
                    }
                    requestAnimationFrame(frame);
                  }

                  function mountObserver(){
                    const io = new IntersectionObserver((entries, obs)=>{
                      entries.forEach(entry=>{
                        if (entry.isIntersecting){
                          const el = entry.target;
                          const target = parseFloat(el.dataset.target);
                          const unit = el.dataset.unit || '';
                          animateCount(el, target, unit);
                          obs.unobserve(el);
                        }
                      });
                    }, { threshold: 0.25 });
                    document.querySelectorAll('.stats-grid .value[data-target]').forEach(el => io.observe(el));
                  }

                  // ---------- Cache + render por idioma ----------
                  let cachedRows = [];

                  function mapRowToRecord(cells, lang){
                    // A: Statistic (num o string)
                    // B: Unit
                    // C: Text (EN)
                    // D: Texto (ES)
                    const c = cells || [];
                    const rawStat = cellVal(c[0]);
                    const unit    = cellStr(c[1]);
                    const label   = (lang === 'EN') ? cellStr(c[2]) : cellStr(c[3]);

                    // Parseo a número si posible
                    let n = rawStat;
                    if (typeof n !== 'number'){
                      const parsed = parseFloat(clean(String(n)).replace(/,/g,''));
                      if (!isNaN(parsed)) n = parsed;
                    }
                    return { valueRaw: rawStat, valueNum: n, unit, label };
                  }

                  function renderStatsForLang(lang){
                    const grid = document.querySelector('#stats .stats-grid');
                    if (!grid) return;
                    grid.innerHTML = '';

                    const rows = cachedRows.slice(); // sin reverse: son KPIs, el orden del sheet manda
                    const frag = document.createDocumentFragment();

                    rows.forEach(r=>{
                      const rec = mapRowToRecord(r?.c || [], lang);

                      const div  = document.createElement('div');
                      div.className = 'cell';
                      const pVal = document.createElement('p');
                      pVal.className = 'value';
                      const pLbl = document.createElement('p');
                      pLbl.className = 'label';
                      pLbl.textContent = rec.label || '';

                      // Si no es numérico, mostramos texto final sin animación
                      if (typeof rec.valueNum !== 'number' || !isFinite(rec.valueNum)){
                        pVal.textContent = finalText(rec.valueRaw, rec.unit);
                      } else {
                        const u = clean(rec.unit).toLowerCase();
                        pVal.dataset.target = String(rec.valueNum);
                        pVal.dataset.unit = u;
                        // Estado inicial 0 con unidad
                        if (u === '%')      pVal.textContent = `${formatCompact(0)}%`;
                        else if (u === '$') pVal.textContent = `$${formatCompact(0)}`;
                        else                pVal.textContent = u ? `${formatCompact(0)} ${u}` : formatCompact(0);
                      }

                      div.appendChild(pVal);
                      div.appendChild(pLbl);
                      frag.appendChild(div);
                    });

                    grid.appendChild(frag);
                    mountObserver();
                  }

                  async function fetchOnceAndRender(){
                    const grid = document.querySelector('#stats .stats-grid');
                    if (!grid) return;
                    grid.innerHTML = '';

                    try{
                      const res = await fetch(jsonUrl, { cache:'no-store' });
                      const txt = await res.text();
                      const a = txt.indexOf('setResponse('), b = txt.lastIndexOf(');');
                      if (a === -1 || b === -1){
                        grid.innerHTML = `<div style='padding:16px;color:#f88'>No pude leer el Sheet (GViz).</div>`;
                        return;
                      }
                      const data = JSON.parse(txt.substring(a + 'setResponse('.length, b));
                      let rows = data?.table?.rows || [];
                      if (!rows.length){
                        grid.innerHTML = `<div style='padding:16px;color:#f88'>Hoja vacía.</div>`;
                        return;
                      }
                      if (isHeaderRow(rows[0])) rows = rows.slice(1);
                      cachedRows = rows;

                      renderStatsForLang(getCurrentLang());
                    } catch(e){
                      console.error(e);
                      grid.innerHTML = `<div style='padding:16px;color:#f88'>Error al leer la hoja.</div>`;
                    }
                  }

                  // Carga inicial
                  window.addEventListener('load', fetchOnceAndRender);

                  // Redibuja al cambiar idioma
                  window.addEventListener('languagechange', () => {
                    renderStatsForLang(getCurrentLang());
                  });

                  // Por si cambian localStorage desde otra pestaña/iframe
                  window.addEventListener('storage', (ev) => {
                    if (ev.key === 'site:lang') {
                      renderStatsForLang(getCurrentLang());
                    }
                  });
                })();
              </script>
            </div>
          </div>
        </section>
        <section
          id="cases"
          data-nav-endata-nav-en="Use Cases"
          data-nav-es="Casos de Uso"
          class="home-cases"
        >
          <div class="home-container27">
            <div class="home-container28">
              <section
                id="usecases"
                style="
  width:100%;
  max-width:1100px;
  margin:0 auto;
  padding:0 clamp(12px,3vw,32px);
  box-sizing:border-box;
  color:#fff;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
"
              >
                <h2
                  class="uc-heading"
                  style="
    margin:0 0 clamp(28px,6vw,60px) 0;
    font-size:calc(clamp(18px,2.6vw,26px) * 2);
    font-weight:800;
    line-height:1.2;
    text-align:center;
    color:#fff;
  "
                >
                  Use Cases
                </h2>

                <div class="uc-grid"></div>

                <!-- Modal -->
                <div
                  id="uc-modal-backdrop"
                  class="uc-modal-backdrop"
                  role="dialog"
                  aria-modal="true"
                  aria-labelledby="uc-modal-title"
                >
                  <div class="uc-modal" tabindex="-1">
                    <button
                      class="uc-modal-close"
                      type="button"
                      aria-label="Close"
                    >
                      ✕ Cerrar
                    </button>
                    <h3 id="uc-modal-title"></h3>
                    <p id="uc-modal-body"></p>
                    <div id="uc-modal-media" style="margin-top:16px;"></div>
                  </div>
                </div>
              </section>

              <style>
                .uc-grid{
                  display:grid;
                  grid-template-columns:repeat(2,1fr);
                  align-items:start;
                  gap:0;
                }
                .uc-item{
                  position:relative;
                  padding:clamp(18px,2.6vw,28px);
                  border-left:1px solid rgba(255,255,255,0.15);
                  border-bottom:1px solid rgba(255,255,255,0.15);
                }
                .uc-item:nth-child(2n+1){ border-left:none; }

                .uc-title{
                  margin:0 0 8px 0;
                  font-weight:800;
                  line-height:1.25;
                  font-size:clamp(18px,2.6vw,26px);
                  color:#fff;
                }

                .uc-desc{
                  margin:0;
                  color:rgba(255,255,255,.85);
                  font-size:clamp(14px,2.1vw,16px);
                  line-height:1.6;
                  white-space:pre-wrap;
                }
                .uc-desc.truncated{
                  --uc-max-lines: 4;
                  max-height: calc(var(--uc-max-lines,4) * 1.6em);
                  overflow:hidden;
                  display:-webkit-box;
                  -webkit-line-clamp: var(--uc-max-lines,4);
                  -webkit-box-orient: vertical;
                  -webkit-mask-image: linear-gradient(180deg, #000 70%, rgba(0,0,0,0) 100%);
                          mask-image: linear-gradient(180deg, #000 70%, rgba(0,0,0,0) 100%);
                }

                .uc-read-more{
                  position:absolute;
                  right:clamp(12px,2vw,16px);
                  bottom:clamp(12px,2vw,16px);
                  padding:6px 10px;
                  border-radius:8px;
                  background:rgba(255,255,255,0.12);
                  color:#fff;
                  font-size:12px;
                  font-weight:600;
                  letter-spacing:.2px;
                  border:1px solid rgba(255,255,255,0.2);
                  cursor:pointer;
                  backdrop-filter: blur(4px);
                  transition:transform .15s ease, background .2s ease;
                }
                .uc-item.uc-has-button{ padding-bottom:calc(clamp(18px,2.6vw,28px) + 38px); }
                .uc-read-more:hover{ transform:translateY(-1px); background:rgba(255,255,255,0.18); }

                /* Media (solo se usa dentro del modal, pero dejo estilos namespaced) */
                .uc-media{
                  margin:0 0 clamp(10px,1.5vw,16px) 0;
                  border-radius:12px;
                  overflow:hidden;
                }
                .uc-media > img,
                .uc-media > video{ display:block; width:100%; height:auto; border-radius:12px; object-fit:cover; }

                .uc-iframe-box{
                  position:relative; width:100%; aspect-ratio:16/9; background:#000;
                  border-radius:12px; overflow:hidden; max-height:85vh;
                }
                .uc-iframe-box[data-ratio='9/16']{ aspect-ratio:9/16; }
                .uc-iframe-box > iframe{ position:absolute; inset:0; width:100%; height:100%; border:0; display:block; }

                .uc-linkwrap{ text-align:center; }
                .uc-linkbtn{
                  display:inline-block; margin-top:10px; padding:12px 20px; border-radius:10px;
                  background:#2b2b2b; text-decoration:none; font-weight:700;
                  font-size:clamp(14px,1.8vw,16px); color:#fff; box-shadow:0 2px 6px rgba(0,0,0,.3);
                  transition:all .25s ease; transform-origin:center;
                }
                .uc-linkbtn:hover{
                  background:#3a3a3a; box-shadow:0 0 15px rgba(180,180,180,.6), 0 0 30px rgba(180,180,180,.4);
                  transform:scale(1.07) rotate(-1deg);
                }

                @media (max-width:800px){
                  .uc-grid{ grid-template-columns:1fr; }
                  .uc-item{ border-left:none; }
                  .uc-item:first-child{ border-top:1px solid rgba(255,255,255,0.15); }
                }

                /* Modal */
                .uc-modal-backdrop{
                  position:fixed; inset:0; background:rgba(0,0,0,.55);
                  display:none; align-items:center; justify-content:center; z-index:9999;
                }
                .uc-modal-backdrop.open{ display:flex; }
                .uc-modal{
                  width:min(900px, 92vw); max-height:85vh; background:#0f1115; color:#fff;
                  border:1px solid rgba(255,255,255,0.18); border-radius:16px;
                  box-shadow:0 20px 60px rgba(0,0,0,.45); padding:clamp(16px,2.5vw,24px); overflow:auto;
                }
                .uc-modal h3{ margin:0 0 12px 0; font-size:clamp(18px,2.2vw,24px); font-weight:800; line-height:1.25; }
                .uc-modal p{ margin:0; font-size:clamp(14px,2.1vw,16px); line-height:1.7; white-space:pre-wrap; color:rgba(255,255,255,.92); }
                .uc-modal-close{
                  position:sticky; top:0; margin-left:auto; display:inline-flex; align-items:center; gap:8px;
                  padding:6px 10px; border-radius:10px; background:rgba(255,255,255,0.08); color:#fff;
                  font-size:12px; border:1px solid rgba(255,255,255,0.18); cursor:pointer; float:right;
                }
              </style>

              <script>
                (() => {
                  const ROOT = document.getElementById('usecases');
                  if (!ROOT) return;

                  /* === Sheet fijo (A..G) === */
                  const SHEET_ID  = '14Z6jZrF9j9J08PQFLHTJL2PuEnQ62HCE0pGJ80gqaeQ';
                  const SHEET_GID = '1421800987';
                  const jsonUrl   = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&gid=${encodeURIComponent(SHEET_GID)}`;

                  /* === Truncado === */
                  const MAX_LINES = 4;
                  const LENGTH_THRESHOLD = 180;
                  const LINE_HEIGHT = 1.6;

                  /* === Helpers (scoped) === */
                  const clean   = s => (s ?? '').toString().replace(/[\u00A0\u202F\u2007]/g,' ').trim();
                  const cellTxt = c => clean(c?.f ?? c?.v ?? '');
                  const getLang = () => {
                    const v = (window.APP_LANG || localStorage.getItem('site:lang') || 'ES').toString().toUpperCase();
                    return v === 'EN' ? 'EN' : 'ES';
                  };

                  // Detectores de medios (para el MODAL)
                  const ucIsVideoFile = u => /\.(mp4|webm|ogg)(\?|#|$)/i.test(u||'');
                  const ucVimeoMatch  = u => (u||'').match(/vimeo\.com\/(\d+)/);
                  const ucTikTokMatch = u => (u||'').match(/tiktok\.com\/@[^/]+\/video\/(\d+)/);
                  const ucDriveMatch  = u => (u||'').match(/drive\.google\.com\/file\/d\/([^/]+)/);
                  const ucIsYouTube   = u => /(?:youtu\.be\/|youtube\.com\/watch\?v=)/i.test(u||'');
                  const ucIsInstagram = u => /instagram\.com\/(?:p|reel)\//i.test(u||'');

                  function ucCreateIframeBox(src, {ratio='16/9'} = {}){
                    const box = document.createElement('div');
                    box.className = 'uc-media uc-iframe-box';
                    box.dataset.ratio = ratio;
                    const i = document.createElement('iframe');
                    i.src = src; i.loading='lazy'; i.allowFullscreen = true;
                    box.appendChild(i);
                    return box;
                  }

                  function ucRenderMedia({url, poster, lang}){
                    const s = (url||'').trim();
                    if (!s) return null;

                    if (ucIsVideoFile(s)){
                      const v=document.createElement('video');
                      v.src=s; v.controls=true; v.playsInline=true;
                      if (poster) v.setAttribute('poster', poster);
                      v.className='uc-media';
                      return v;
                    }
                    const vm = ucVimeoMatch(s);
                    if (vm) return ucCreateIframeBox(`https://player.vimeo.com/video/${vm[1]}`, {ratio:'16/9'});

                    const tk = ucTikTokMatch(s);
                    if (tk) return ucCreateIframeBox(`https://www.tiktok.com/embed/${tk[1]}`, {ratio:'9/16'});

                    const gd = ucDriveMatch(s);
                    if (gd) return ucCreateIframeBox(`https://drive.google.com/file/d/${gd[1]}/preview`, {ratio:'16/9'});

                    // YouTube / Instagram → botón dentro del modal
                    if (ucIsYouTube(s) || ucIsInstagram(s)){
                      const wrap = document.createElement('div');
                      wrap.className = 'uc-linkwrap';
                      const a = document.createElement('a');
                      a.href = s; a.target = '_blank'; a.rel = 'noopener';
                      a.className = 'uc-linkbtn';
                      a.textContent = ucIsYouTube(s)
                        ? (lang==='EN' ? 'Watch on YouTube'   : 'Ver en YouTube')
                        : (lang==='EN' ? 'View on Instagram' : 'Ver en Instagram');
                      wrap.appendChild(a);
                      return wrap;
                    }

                    // Default: imagen
                    const img=document.createElement('img');
                    img.src=s; img.alt=''; img.loading='lazy';
                    const wrap=document.createElement('div');
                    wrap.className='uc-media';
                    wrap.appendChild(img);
                    return wrap;
                  }

                  /* === Estado === */
                  let cachedRows = [];
                  let openIndex  = null;

                  /* === Modal === */
                  const modalBackdrop = ROOT.querySelector('#uc-modal-backdrop');
                  const modalTitleEl  = ROOT.querySelector('#uc-modal-title');
                  const modalBodyEl   = ROOT.querySelector('#uc-modal-body');
                  const modalMediaEl  = ROOT.querySelector('#uc-modal-media');
                  const modalCloseBtn = ROOT.querySelector('.uc-modal-close');

                  function openUCModal({ title, body, media, href, poster, lang }, rowIndex){
                    modalTitleEl.textContent = title || '';
                    modalBodyEl.textContent  = body  || '';
                    modalMediaEl.innerHTML   = '';

                    const url = (media || href || '').trim();
                    if (url){
                      const mediaEl = ucRenderMedia({ url, poster, lang });
                      if (mediaEl) modalMediaEl.appendChild(mediaEl);
                    }

                    modalBackdrop.classList.add('open');
                    openIndex = rowIndex ?? null;
                    (modalCloseBtn || modalBackdrop.querySelector('.uc-modal'))?.focus();
                  }
                  function closeUCModal(){ modalBackdrop.classList.remove('open'); openIndex = null; }
                  modalCloseBtn.addEventListener('click', closeUCModal);
                  modalBackdrop.addEventListener('click', e => { if (e.target === modalBackdrop) closeUCModal(); });
                  window.addEventListener('keydown', e => { if (e.key === 'Escape' && modalBackdrop.classList.contains('open')) closeUCModal(); });

                  /* === Mapeo A..G === */
                  // A: EN Title(0), B: EN Text(1), C: ES Title(2), D: ES Text(3), E: Media(4), F: Href(5), G: Poster(6)
                  function mapRowToUC(cells, lang){
                    const c = cells || [];
                    return (lang === 'EN')
                      ? { t: cellTxt(c[0]), d: cellTxt(c[1]), m: cellTxt(c[4]), h: cellTxt(c[5]), p: cellTxt(c[6]) }
                      : { t: cellTxt(c[2]), d: cellTxt(c[3]), m: cellTxt(c[4]), h: cellTxt(c[5]), p: cellTxt(c[6]) };
                  }

                  function renderUCForLang(lang){
                    const grid = ROOT.querySelector('.uc-grid');
                    if (!grid) return;
                    grid.innerHTML = '';

                    const h2 = ROOT.querySelector('.uc-heading');
                    if (h2){ h2.textContent = (lang === 'EN') ? 'Use Cases' : 'Casos de uso'; }

                    const frag = document.createDocumentFragment();

                    cachedRows.forEach((r, idx)=>{
                      const uc = mapRowToUC(r?.c || [], lang);
                      // Si no hay nada, salta
                      if (!uc.t && !uc.d && !uc.m && !uc.h) return;

                      const item = document.createElement('article');
                      item.className = 'uc-item';
                      item.dataset.rowIndex = idx.toString();

                      // Título
                      if (uc.t){
                        const h3 = document.createElement('h3');
                        h3.className = 'uc-title';
                        h3.textContent = uc.t;
                        item.appendChild(h3);
                      }

                      // Descripción (en la tarjeta principal) — SIN media aquí
                      if (uc.d){
                        const p = document.createElement('p');
                        p.className = 'uc-desc';
                        p.textContent = uc.d;
                        item.appendChild(p);
                      }

                      // (No se añade media en la vista principal)

                      frag.appendChild(item);
                    });

                    grid.appendChild(frag);

                    // Truncado + botón (aparece si el texto es largo O si hay media/link)
                    grid.querySelectorAll('.uc-item').forEach(item=>{
                      const idx = Number(item.dataset.rowIndex || -1);
                      const rec = cachedRows[idx];
                      const langNow = getLang();
                      const uc = mapRowToUC(rec?.c || [], langNow);

                      const p = item.querySelector('.uc-desc');
                      const hasMedia = !!(uc.m || uc.h);

                      let needButton = hasMedia; // botón si hay media/link aunque el texto sea corto
                      if (p){
                        const fs = parseFloat(getComputedStyle(p).fontSize) || 16;
                        const maxPx = MAX_LINES * LINE_HEIGHT * fs;
                        const overflow = p.scrollHeight > maxPx * 1.02;
                        const longText = p.textContent.length > LENGTH_THRESHOLD;
                        if (overflow || longText) needButton = true;
                        if (overflow) p.classList.add('truncated');
                      }

                      if (needButton){
                        item.classList.add('uc-has-button');
                        let btn = item.querySelector('.uc-read-more');
                        if (!btn){
                          btn = document.createElement('button');
                          btn.type = 'button';
                          btn.className = 'uc-read-more';
                          item.appendChild(btn);
                        }
                        btn.textContent = (langNow==='EN') ? 'Read more' : 'Leer más';
                      }
                    });

                    // Sincroniza modal si está abierto (re-render idioma)
                    if (openIndex !== null && openIndex >= 0 && openIndex < cachedRows.length){
                      const uc = mapRowToUC(cachedRows[openIndex]?.c || [], lang);
                      openUCModal({ title: uc.t || '', body: uc.d || '', media: uc.m, href: uc.h, poster: uc.p, lang }, openIndex);
                    }

                    // Texto del botón cerrar
                    if (modalCloseBtn){
                      modalCloseBtn.textContent = (lang==='EN') ? '✕ Close' : '✕ Cerrar';
                      modalCloseBtn.setAttribute('aria-label', (lang==='EN') ? 'Close' : 'Cerrar');
                    }
                  }

                  async function fetchUCAndRender(){
                    const grid = ROOT.querySelector('.uc-grid');
                    if (!grid) return;
                    grid.innerHTML = '';

                    try{
                      const res = await fetch(jsonUrl, { cache:'no-store' });
                      const txt = await res.text();
                      const i = txt.indexOf('setResponse('), j = txt.lastIndexOf(');');
                      if (i === -1 || j === -1){
                        grid.innerHTML = `<div style='padding:16px;color:#f88'>No pude leer el Sheet (GViz).</div>`;
                        return;
                      }
                      const data = JSON.parse(txt.substring(i + 'setResponse('.length, j));
                      let rows = data?.table?.rows || [];
                      if (!rows.length){
                        grid.innerHTML = `<div style='padding:16px;color:#f88'>Hoja vacía.</div>`;
                        return;
                      }

                      // Quita encabezado (primera fila)
                      rows = rows.slice(1);

                      cachedRows = rows;
                      renderUCForLang(getLang());
                    }catch(err){
                      console.error(err);
                      grid.innerHTML = `<div style='padding:16px;color:#f88'>Error al leer la hoja.</div>`;
                    }
                  }

                  // Delegación: abrir modal
                  ROOT.addEventListener('click', (e)=>{
                    const btn = e.target.closest?.('.uc-read-more');
                    if (!btn || !ROOT.contains(btn)) return;
                    const item = btn.closest('.uc-item');
                    if (!item) return;
                    const idx = Number(item.dataset.rowIndex || -1);
                    if (idx < 0) return;

                    const lang = getLang();
                    const uc = mapRowToUC(cachedRows[idx]?.c || [], lang);
                    openUCModal({ title: uc.t || '', body: uc.d || '', media: uc.m, href: uc.h, poster: uc.p, lang }, idx);
                  });

                  // Inicial + re-render por idioma
                  window.addEventListener('load', fetchUCAndRender);
                  window.addEventListener('languagechange', () => renderUCForLang(getLang()));
                  window.addEventListener('storage', ev => { if (ev.key === 'site:lang') renderUCForLang(getLang()); });
                })();
              </script>
            </div>
          </div>
        </section>
        <section
          id="faq"
          data-nav-en="FAQ"
          data-nav-es="Preguntas Frecuentes"
          class="home-faq"
        >
          <div>
            <div class="home-container30">
              <script>
                (function(){
                  // Cambia estos textos por los de esa sección
                  var en='FAQ', es='Preguntas Frecuentes';
                  var host = document.currentScript.parentElement;
                  if(host){
                    host.setAttribute('data-nav-en', en);
                    host.setAttribute('data-nav-es', es);
                    host.classList.add('nav-section'); // opcional, útil para depurar
                  }
                })();
              </script>
            </div>
          </div>
          <div class="home-container31">
            <div class="home-container32">
              <section
                id="faq"
                style="
  width:100%;
  max-width:1100px;
  margin:0 auto;
  padding:0 clamp(12px,3vw,32px);
  box-sizing:border-box;
  color:#fff;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
"
              >
                <!-- ✅ Título principal -->
                <h2
                  class="faq-title"
                  style="
    margin:0 0 clamp(28px,6vw,60px) 0;
    font-size:calc(clamp(18px,2.6vw,26px) * 2);
    font-weight:800;
    line-height:1.2;
    text-align:center;
    color:#fff;
  "
                >
                  Frequently Asked Questions
                </h2>

                <div class="faq-grid"></div>
              </section>

              <style>
                .faq-grid{
                  display:grid;
                  grid-template-columns:repeat(2,1fr);
                  align-items:start;
                  gap:0;
                }
                .faq-grid .faq-item{
                  padding:clamp(18px,2.6vw,28px);
                  border-left:1px solid rgba(255,255,255,0.15);
                  border-bottom:1px solid rgba(255,255,255,0.15);
                }
                .faq-grid .faq-item:nth-child(2n+1){ border-left:none; }

                .faq-grid .q{
                  margin:0 0 10px 0;
                  font-weight:800;
                  line-height:1.25;
                  font-size:clamp(18px,2.6vw,26px);
                  color:#fff;
                }
                .faq-grid .a{
                  margin:0;
                  color:rgba(255,255,255,.85);
                  font-size:clamp(14px,2.1vw,16px);
                  line-height:1.6;
                  white-space:pre-wrap;
                }

                @media (max-width:800px){
                  .faq-grid{ grid-template-columns:1fr; }
                  .faq-grid .faq-item{ border-left:none; }
                  .faq-grid .faq-item:first-child{ border-top:1px solid rgba(255,255,255,0.15); }
                }
              </style>

              <script>
                (() => {
                  /* ========= Sheet de Google y hoja ========= */
                  const SHEET_ID   = '14Z6jZrF9j9J08PQFLHTJL2PuEnQ62HCE0pGJ80gqaeQ';
                  const SHEET_GID  = '1140753597';  // ← TU gid
                  const RANGE      = 'A:D';        // columnas

                  const params = new URLSearchParams({ tqx: 'out:json' });
                  if (SHEET_GID) params.set('gid', SHEET_GID);
                  if (RANGE)     params.set('range', RANGE);

                  const jsonUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?${params.toString()}`;

                  // ---------- Utils ----------
                  const clean    = s => (s ?? '').toString().replace(/[\u00A0\u202F\u2007]/g,' ').trim();
                  const cellText = c => clean(c?.f ?? c?.v ?? '');
                  const getLang  = () => {
                    const val = (window.APP_LANG || localStorage.getItem('site:lang') || 'ES').toString().toUpperCase();
                    return val === 'EN' ? 'EN' : 'ES';
                  };

                  // --------- Cache y mapeo por idioma ----------
                  let cachedRows = [];

                  function mapRowToQA(cells, lang){
                    // EN => c[0]=Question, c[1]=Answer
                    // ES => c[2]=Pregunta, c[3]=Respuesta
                    const c = cells || [];
                    if (lang === 'EN'){
                      return { q: cellText(c[0]), a: cellText(c[1]) };
                    } else {
                      return { q: cellText(c[2]), a: cellText(c[3]) };
                    }
                  }

                  function renderFAQForLang(lang){
                    const grid = document.querySelector('#faq .faq-grid');
                    if (!grid) return;
                    grid.innerHTML = '';

                    // Cambia el título H2 según idioma
                    const h2 = document.querySelector('#faq .faq-title');
                    if (h2){
                      h2.textContent = (lang === 'EN') ? 'Frequently Asked Questions' : 'Preguntas Frecuentes';
                    }

                    const frag = document.createDocumentFragment();
                    cachedRows.forEach(r=>{
                      const qa = mapRowToQA(r?.c || [], lang);
                      if (!qa.q && !qa.a) return;

                      const item = document.createElement('article');
                      item.className = 'faq-item';

                      const h3 = document.createElement('h3');
                      h3.className = 'q';
                      h3.textContent = qa.q || '';

                      const p = document.createElement('p');
                      p.className = 'a';
                      p.textContent = qa.a || '';

                      item.appendChild(h3);
                      item.appendChild(p);
                      frag.appendChild(item);
                    });

                    grid.appendChild(frag);
                  }

                  async function fetchOnceAndRender(){
                    const grid = document.querySelector('#faq .faq-grid');
                    if (!grid) return;
                    grid.innerHTML = '';

                    try{
                      const res = await fetch(jsonUrl, { cache:'no-store' });
                      const txt = await res.text();
                      const i = txt.indexOf('setResponse('), j = txt.lastIndexOf(');');
                      if (i === -1 || j === -1){
                        grid.innerHTML = `<div style='padding:16px;color:#f88'>No pude leer el Sheet (GViz).</div>`;
                        return;
                      }
                      const data = JSON.parse(txt.substring(i + 'setResponse('.length, j));
                      let rows = data?.table?.rows || [];
                      if (!rows.length){
                        grid.innerHTML = `<div style='padding:16px;color:#f88'>Hoja vacía.</div>`;
                        return;
                      }

                      // 🔑 Omitir SIEMPRE el primer renglón (encabezados)
                      rows = rows.slice(1);

                      cachedRows = rows;
                      renderFAQForLang(getLang());
                    }catch(err){
                      console.error(err);
                      if (grid) grid.innerHTML = `<div style='padding:16px;color:#f88'>Error al leer la hoja.</div>`;
                    }
                  }

                  // Inicial
                  window.addEventListener('load', fetchOnceAndRender);

                  // Redibujar al cambiar idioma
                  window.addEventListener('languagechange', () => {
                    renderFAQForLang(getLang());
                  });

                  // Por si cambia localStorage desde otra pestaña/iframe
                  window.addEventListener('storage', (ev) => {
                    if (ev.key === 'site:lang') {
                      renderFAQForLang(getLang());
                    }
                  });
                })();
              </script>
            </div>
          </div>
        </section>
        <section
          id="contact"
          data-nav-en="Contact"
          data-nav-es="Contacto"
          class="home-comtact"
        >
          <div class="home-container33">
            <div class="home-container34">
              <script>
                (function(){
                  // Cambia estos textos por los de esa sección
                  var en='Contact', es='Contacto';
                  var host = document.currentScript.parentElement;
                  if(host){
                    host.setAttribute('data-nav-en', en);
                    host.setAttribute('data-nav-es', es);
                    host.classList.add('nav-section'); // opcional, útil para depurar
                  }
                })();
              </script>
            </div>
          </div>
          <div class="home-container35">
            <div class="home-container36">
              <section
                id="contact-card"
                style="width:100%;max-width:560px;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif"
              >
                <div class="contact-inner"></div>
              </section>

              <style>
                #contact-card .title {
                  font-weight: 700;
                  font-size: clamp(18px, 2.4vw, 22px);
                  margin: 0 0 12px 0
                }

                #contact-card .row {
                  display: flex;
                  align-items: flex-start;
                  gap: 10px;
                  padding: 10px 0
                }

                #contact-card .ico {
                  width: 22px;
                  height: 22px;
                  flex: 0 0 22px;
                  margin-top: 2px;
                  color: currentColor;
                  fill: currentColor
                }

                #contact-card a {
                  color: #8ab4ff;
                  text-decoration: none
                }

                #contact-card a:hover {
                  text-decoration: underline
                }

                #contact-card .label {
                  font-weight: 600;
                  margin: 0;
                  font-size: 14px;
                  opacity: .9
                }

                #contact-card .val {
                  margin: 2px 0 0 0;
                  font-size: 14px;
                  word-break: break-word
                }

                #contact-card .socials {
                  display: flex;
                  gap: 14px;
                  padding-top: 18px;
                  flex-wrap: wrap
                }

                #contact-card .socials a {
                  display: inline-flex;
                  width: 22px;
                  height: 22px;
                  color: inherit
                }

                #contact-card .socials a svg {
                  width: 100%;
                  height: 100%;
                  fill: currentColor
                }
              </style>

              <script>
                  (() => {
                  // === TU HOJA ===
                  const SHEET_ID  = '14Z6jZrF9j9J08PQFLHTJL2PuEnQ62HCE0pGJ80gqaeQ';
                  const SHEET_GID = '491949069';
                  const RANGE     = 'A1:B200';

                  const params  = new URLSearchParams({ tqx:'out:json', gid:SHEET_GID, range:RANGE });
                  const jsonUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?${params.toString()}&cb=${Date.now()}`;

                  const clean = s => (s||'').toString().replace(/[\u00A0\u202F\u2007]/g,' ').trim();
                  const norm  = s => clean(s).toLowerCase()
                                  .replace(/\s+/g,' ')
                                  .replace(/[áàä]/g,'a').replace(/[éèë]/g,'e').replace(/[íìï]/g,'i')
                                  .replace(/[óòö]/g,'o').replace(/[úùü]/g,'u').replace(/ñ/g,'n');

                  const icons = {
                    globe:`<svg viewBox='0 0 24 24' class='ico' aria-hidden='true'><path d='M12 2a10 10 0 100 20 10 10 0 000-20zm7.9 9h-3.2a15 15 0 00-1.1-5 8 8 0 014.3 5zM12 4a13 13 0 011.8 7H10.2A13 13 0 0112 4zM7.4 16A13 13 0 016 12H2.1a8 8 0 005.3 7.2A15 15 0 017.4 16zM6 12a15 15 0 001.1 5h-3A8 8 0 012.1 12H6zm10.5 5a15 15 0 001.1-5h3.2a8 8 0 01-4.3 5zM12 20a13 13 0 01-1.8-7h3.6A13 13 0 0112 20z'/></svg>`,
                    mail:`<svg viewBox='0 0 24 24' class='ico' aria-hidden='true'><path d='M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z'/></svg>`,
                    phone:`<svg viewBox='0 0 24 24' class='ico' aria-hidden='true'><path d='M6.6 10.8a15.5 15.5 0 006.6 6.6l2.2-2.2c.3-.3.7-.4 1.1-.3 1.2.4 2.6.7 4 .7.6 0 1 .4 1 1V21c0 .6-.4 1-1 1C10.1 22 2 13.9 2 3c0-.6.4-1 1-1h3.4c.6 0 1 .4 1 1 0 1.4.2 2.8.7 4 .1.4 0 .8-.3 1.1l-2.2 2.2z'/></svg>`,
                    clock:`<svg viewBox='0 0 24 24' class='ico' aria-hidden='true'><path d='M12 1.9A10.1 10.1 0 112 12 10.1 10.1 0 0112 1.9zm.8 5h-1.6v5.1l4.3 2.6.8-1.3-3.5-2.1V6.9z'/></svg>`,
                    li:`<svg viewBox='0 0 24 24' aria-hidden='true'><path d='M4.98 3.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5zM3 8.98h4v12H3v-12zM9 8.98h3.8v1.6h.1c.5-.9 1.8-1.9 3.7-1.9 4 0 4.7 2.6 4.7 6v6.3h-4v-5.6c0-1.3 0-3-1.9-3s-2.2 1.4-2.2 2.9v5.7H9v-12z'/></svg>`,
                    fb:`<svg viewBox='0 0 24 24' aria-hidden='true'><path d='M13 10h3V7h-3c-1.7 0-3 1.3-3 3v2H8v3h2v6h3v-6h2.2l.8-3H13v-2c0-.6.4-1 1-1z'/></svg>`,
                    ig:`<svg viewBox='0 0 24 24' aria-hidden='true'><path d='M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm5 5a5 5 0 100 10 5 5 0 000-10zm6.5-.9a1.1 1.1 0 10.001 2.201A1.1 1.1 0 0018.5 6.1z'/></svg>`,
                    tt:`<svg viewBox='0 0 24 24' aria-hidden='true'><path d='M14 3h3s.3 2.8 5 3v3c-2.1.2-3.9-.5-5-1.4V16a5.9 5.9 0 11-6.5-5.9V13a2.9 2.9 0 102.5 2.9V3z'/></svg>`,
                    x:`<svg viewBox='0 0 24 24' aria-hidden='true'><path d='M3 3h4.7l5.5 7.6L19 3h2l-7 9.5L21 21h-4.7l-5.9-8.1L9 21H7l1.6-6.1L3 3z'/></svg>`,
                    wa:`<svg viewBox='0 0 24 24' aria-hidden='true'><path d='M20 4.9A9.7 9.7 0 003.2 18.5L2 22l3.6-1a9.7 9.7 0 004.7 1.2h.1A9.7 9.7 0 2020 4.9zM6.5 19l-.2.1-.9.2.3-.9.1-.2a7.8 7.8 0 1114-4.3 7.8 7.8 0 01-7.7 7.8H12A7.7 7.7 0 016.5 19zm10-5.2c-.2-.1-1.4-.7-1.6-.8-.2-.1-.4-.1-.6.1l-.5.6c-.1.2-.3.2-.5.1-.2-.1-.9-.3-1.7-1.1-.6-.6-1-1.3-1.1-1.5-.1-.2 0-.3.1-.5l.3-.4c.1-.2.1-.3 0-.5l-.8-1.9c-.2-.4-.4-.3-.6-.3h-.5c-.2 0-.5.1-.7.3-.8.8-1.1 2-1.1 3.1 0 1.8 1.3 3.5 1.5 3.7.2.3 2.5 4 6.1 5.4 1.1.4 2 .6 2.6.8.9.3 1.7.2 2.3.1.7-.1 2.2-.9 2.5-1.7.3-.8.3-1.5.2-1.7-.1-.2-.3-.3-.6-.5z'/></svg>`
                  };

                  const ensureHttps = url => {
                    const u = clean(url);
                    if (!u) return '';
                    if (/^https?:\/\//i.test(u)) return u;
                    if (/^[\w.-]+\.[a-z]{2,}(\/|$)/i.test(u)) return 'https://' + u;
                    return u;
                  };
                  const mailto = v => `mailto:${clean(v)}`;
                  const tel = v => `tel:${clean(v).replace(/[^\d+]/g,'')}`;
                  const waLink = v => {
                    const n = clean(v).replace(/[^\d+]/g,'');
                    return n ? `https://wa.me/${n.replace(/^\+/, '')}` : '';
                  };

                  const rowHTML = (svg,label,inner) => `
                    <div class='row'>
                      ${svg}
                      <div>
                        <p class='label'>${label}</p>
                        <p class='val'>${inner}</p>
                      </div>
                    </div>`;
                  const socialIcon = (href, svg, label) =>
                    href ? `<a href='${href}' target='_blank' rel='noopener' aria-label='${label}'>${svg}</a>` : '';

                  function detectSocial(url){
                    const u = ensureHttps(url);
                    try{
                      const d = new URL(u).hostname.replace(/^www\./,'').toLowerCase();
                      if (d.includes('linkedin.')) return ['li', u];
                      if (d.includes('instagram.'))return ['ig', u];
                      if (d.includes('facebook.')) return ['fb', u];
                      if (d.includes('tiktok.'))   return ['tt', u];
                      if (d.includes('twitter.') || d === 'x.com') return ['x', u];
                      if (d.includes('wa.me') || d.includes('whatsapp.')) return ['wa', u];
                    }catch(_){}
                    return [null, ''];
                  }

                  function render(pairs){
                    const box = document.querySelector('#contact-card .contact-inner');
                    if (!box) return;

                    const map = {};
                    pairs.forEach(({k,v}) => { if (k || v) map[norm(k)] = v; });

                    const nameKey = Object.keys(map).find(k => k.includes('empresa') || k.includes('compania'));
                    const webKey  = Object.keys(map).find(k => k.includes('sitio') || k.includes('web') || k.includes('pagina') || k.includes('pagin'));
                    const mailKey = Object.keys(map).find(k => k.includes('correo') || k.includes('email') || k.includes('e-mail') || k.includes('mail'));
                    const horaKey = Object.keys(map).find(k => k.includes('horario'));

                    const nombre  = nameKey ? map[nameKey] : '';
                    const web     = webKey  ? ensureHttps(map[webKey]) : '';
                    const correo  = mailKey ? map[mailKey] : '';
                    const horario = horaKey ? map[horaKey] : '';

                    const waKey   = Object.keys(map).find(k => k.includes('whatsapp'));
                    const telKey  = Object.keys(map).find(k => k.includes('tel'));
                    const whats   = waKey ? map[waKey] : '';
                    const telefono= telKey ? map[telKey] : '';

                    const socials = [];
                    pairs.forEach(({v}) => {
                      const val = clean(v);
                      if (!val) return;
                      const isLink = /^https?:\/\//i.test(val) || /^[\w.-]+\.[a-z]{2,}/i.test(val);
                      if (!isLink) return;
                      const [type, href] = detectSocial(val);
                      if (type && href) socials.push([type, href]);
                    });

                    const parts = [];
                    if (nombre) parts.push(`<h3 class='title'>${nombre}</h3>`);
                    if (web)    parts.push(rowHTML(icons.globe, 'Sitio web', `<a href='${web}' target='_blank' rel='noopener'>${web.replace(/^https?:\/\//,'')}</a>`));
                    if (correo) parts.push(rowHTML(icons.mail, 'E-mail', `<a href='${mailto(correo)}'>${correo}</a>`));
                    if (whats)  parts.push(rowHTML(icons.phone, 'WhatsApp / Chat', `<a href='${waLink(whats)}' target='_blank' rel='noopener'>${whats}</a>`));
                    else if (telefono) parts.push(rowHTML(icons.phone, 'Teléfono', `<a href='${tel(telefono)}'>${telefono}</a>`));
                    if (horario)parts.push(rowHTML(icons.clock, 'Horario de atención', `${horario}`));

                    if (socials.length){
                      const s = socials.map(([t,href]) => {
                        if (t==='li') return socialIcon(href, icons.li, 'LinkedIn');
                        if (t==='fb') return socialIcon(href, icons.fb, 'Facebook');
                        if (t==='ig') return socialIcon(href, icons.ig, 'Instagram');
                        if (t==='tt') return socialIcon(href, icons.tt, 'TikTok');
                        if (t==='x')  return socialIcon(href, icons.x,  'X');
                        if (t==='wa') return socialIcon(href, icons.wa, 'WhatsApp');
                        return '';
                      }).join('');
                      parts.push(`<div class='socials' aria-label='Redes sociales'>${s}</div>`);
                    }

                    box.innerHTML = parts.join('\n');
                  }

                  async function loadSheet(){
                    const box = document.querySelector('#contact-card .contact-inner');
                    if (box) box.innerHTML = '';
                    try{
                      const res = await fetch(jsonUrl, {cache:'no-store'});
                      const txt = await res.text();
                      const a = txt.indexOf('setResponse('), b = txt.lastIndexOf(');');
                      if (a === -1 || b === -1) throw new Error('Formato GViz inesperado');
                      const data = JSON.parse(txt.substring(a + 'setResponse('.length, b));
                      let rows = data?.table?.rows || [];
                      if (!rows.length) throw new Error('Hoja vacía');

                      const pairs = rows.map(r => ({
                        k: clean(r?.c?.[0]?.f ?? r?.c?.[0]?.v ?? ''),
                        v: clean(r?.c?.[1]?.f ?? r?.c?.[1]?.v ?? '')
                      })).filter(p => (p.k !== '' || p.v !== ''));

                      if (pairs.length && norm(pairs[0].k).includes('campo') && norm(pairs[0].v).includes('espan'))
                        pairs.shift();

                      render(pairs);
                    } catch(e){
                      console.error(e);
                      if (box) box.innerHTML = `<div style='color:#ff8080'>No pude cargar la información de contacto.</div>`;
                    }
                  }

                  if (document.readyState !== 'loading') loadSheet();
                  else document.addEventListener('DOMContentLoaded', loadSheet, {once:true});
                })();
              </script>
            </div>
          </div>
        </section>
        <section class="home-social-media">
          <div class="home-container37">
            <img
              alt="Engineering Solutions Logo"
              src="public/lbb_logo_hw.svg"
              class="home-image1"
            />
            <div class="home-logo"></div>
          </div>
        </section>
      </div>
    </div>
    <script src="https://unpkg.com/blaze-slider@latest/dist/blaze-slider.min.js"></script>
    <script
      defer=""
      src="https://unpkg.com/@teleporthq/teleport-custom-scripts"
    ></script>
  </body>
</html>
